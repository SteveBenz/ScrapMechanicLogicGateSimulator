(this.webpackJsonplogicgate=this.webpackJsonplogicgate||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);n(50);var i=n(0),o=n(13),r=n(16),a=n(8),s=n(1),c=n.n(s),u=n(45),l=n(2),d=n(46);function f(e){var t=s.useState(0),n=Object(a.a)(t,2),o=n[0],r=n[1],c=s.useState(20),u=Object(a.a)(c,2),d=u[0],f=u[1],h=s.useRef(null);return s.useEffect((function(){function t(){r(e.simulator.currentTick),null!==h.current&&(h.current.text(e.simulator.currentTick.toString()),f(h.current.width()))}return e.simulator.onTick(t),t(),function(){e.simulator.offTick(t)}}),[e.simulator]),Object(i.jsx)(l.Text,{y:e.top,x:e.right-d,ref:h,fill:"red",text:o.toString(),fontSize:30})}var h,m=n(32),v=n.n(m),g=n(4),y=n(34),b=n.n(y),p=n(47),k=n(11),x=n(12),j=n(48),O=n.n(j);function S(e){var t=document.getElementById("error");if(null===t)throw new Error("missing error element");t.innerText=e,t.classList.add("visible"),h&&clearTimeout(h),h=setTimeout((function(){t.classList.remove("visible"),h=void 0}),4e3)}var w=1.05,T=function(){function e(t,n,i){var o=this;Object(k.a)(this,e),this.toolTipId=t,this.x=n,this.y=i,this.timeoutHandle=void 0,this._handleTimeout=function(){if(o.timeoutHandle=void 0,o.toolTipId){var e=document.getElementById(o.toolTipId);if(!e)throw new Error("toolTipId is defined, but not in the document");e.style.visibility="visible";var t=Math.max(0,o.x+32-e.clientWidth/2),n=Math.max(0,o.y-e.clientHeight-5);e.style.top=n+"px",e.style.left=t+"px"}}}return Object(x.a)(e,[{key:"startTimer",value:function(){!this.timeoutHandle&&document.getElementById(this.toolTipId)&&(this.timeoutHandle=setTimeout(this._handleTimeout,1e3))}},{key:"clearTimer",value:function(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=void 0);var e=document.getElementById(this.toolTipId);if(!e)throw new Error("toolTipId is defined, but not in the document");e.style.visibility="hidden"}}]),e}();function _(e){var t=s.useState(!1),n=Object(a.a)(t,2),o=n[0],r=n[1],c=s.useState(!1),u=Object(a.a)(c,2),d=u[0],f=u[1],h=s.useState(new T(e.toolTipId,e.x,e.y)),m=Object(a.a)(h,1)[0];return s.useEffect((function(){return function(){return m.clearTimer()}}),[m]),Object(i.jsxs)(l.Group,{x:e.x-(o?1.6000000000000014:0),y:e.y-(o?1.6000000000000014:0),onMouseEnter:function(){f(!0),m.startTimer()},onMouseLeave:function(t){e.onDragStart&&o&&t.evt.offsetY<e.y+32&&e.onDragStart(t),f(!1),r(!1),m.clearTimer()},onMouseDown:function(){r(!0),m.clearTimer()},onMouseUp:function(t){r(!1),e.onClicked&&e.onClicked(t),m.startTimer()},scaleX:o?w:1,scaleY:o?w:1,children:[e.children,Object(i.jsx)(l.Rect,{x:0,y:0,height:64,width:64,strokeWidth:2,stroke:d?"black":"grey",fill:e.isEnabled?"transparent":"#80808080"})]})}function I(e){var t=s.useState(e.isRunning),n=Object(a.a)(t,2),i=n[0],o=n[1];return s.useEffect((function(){function t(){o(e.isRunning)}return e.onRunStateChanged(t),function(){return e.offRunStateChanged(t)}}),[e]),i}function E(e){var t=I(e.model)?[Object(i.jsx)(l.Line,{points:[27,20,27,44],lineCap:"butt",strokeWidth:5,stroke:"red"},"1"),Object(i.jsx)(l.Line,{points:[37,20,37,44],lineCap:"butt",strokeWidth:5,stroke:"red"},"2")]:Object(i.jsx)(l.Line,{points:[16,16,44,32,16,48],strokeWidth:4,stroke:"green",fill:"green",closed:!0},"3");return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"playPauseTip",isEnabled:!0,onClicked:function(){e.model.isRunning?e.model.stopRunning():e.model.startRunning()},children:t})}function R(e){var t=I(e.model);return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"singleStepTip",isEnabled:!0,onClicked:function(){e.model.advanceOne()},children:Object(i.jsx)(l.Line,{points:[44,32,16,48,16,16,44,32,44,16,44,48],strokeWidth:4,stroke:t?"#305030ff":"#008000ff",closed:!1})})}function C(e){var t,n="input"===e.kind?"inputTip":"timer"===e.kind?"timerTip":"logicGateTip";var o=[!0,!0,!0,!0,!0,!0,!0,!1,!1,!1];function r(e){var t=o.length,n=e<o.length/2?e:o.length-1-e;return n<.2*t?0:n>.4*t?6:6*(n-.2*t)/(.2*t)}switch(e.kind){case"input":t=Object(i.jsx)(l.Circle,{radius:22,x:32,y:32,strokeWidth:8,stroke:"black"});break;case"timer":var a=52/o.length;t=o.map((function(e,t){return Object(i.jsx)(l.Rect,{x:12+r(t),width:40-2*r(t),y:58-a-52*t/o.length,height:a,strokeWidth:1,stroke:"darkgrey",fill:e?"blue":"white"},t.toString())}));break;default:t=Object(i.jsx)(l.Image,{x:0,y:0,image:H[e.kind].image()})}return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:n,isEnabled:!0,onClicked:function(){e.selected?"input"===e.kind&&e.selected instanceof g.a?e.selected.toggle():"timer"===e.kind&&e.selected instanceof g.e?S("Timers can't be changed like this."):"timer"!==e.kind&&"input"!==e.kind&&e.selected instanceof g.d?e.selected.kind=e.kind:S("Can't convert between inputs, timers and gates.  (You have to delete and recreate them)."):S("No logic gate is selected (click on one in the field).")},onDragStart:function(t){var n;switch(e.kind){case"timer":n=new g.e({x:t.evt.offsetX,y:t.evt.offsetY,kind:e.kind,tickStorage:new Array(10).fill(!1)});break;case"input":n=new g.a({x:t.evt.offsetX,y:t.evt.offsetY,savedState:!1,kind:e.kind});break;default:n=new g.d({x:t.evt.offsetX,y:t.evt.offsetY,savedState:!1,kind:e.kind})}e.onBeginDrag({prototype:n,event:t})},children:t})}function B(e){return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"paintTip",isEnabled:!0,onClicked:function(){e.selected instanceof g.c?e.selected.paint():S("Timers always save their current state on reload, so painting them has no effect on its behavior")},children:Object(i.jsx)(l.Image,{x:0,y:0,image:H.paint.image()})})}function L(e){return Object(i.jsxs)(_,{x:e.x,y:e.y,toolTipId:"putOnLiftTip",isEnabled:!0,onClicked:function(){return e.simulator.putOnLift()},children:[Object(i.jsx)(l.Line,{points:[52,48,12,48,12,28,32,28,32,12,16,12,48,12,32,12,32,28,52,28,52,48],strokeWidth:4,stroke:"black",closed:!0},"base"),Object(i.jsx)(l.Line,{points:[18,42,32,32,46,42,18,42],strokeWidth:1,stroke:"blue",closed:!0,fill:"blue"},"arrow")]})}function M(e){return Object(i.jsxs)(_,{x:e.x,y:e.y,toolTipId:"takeOffLiftTip",isEnabled:!0,onClicked:function(){return e.simulator.takeOffLift()},children:[Object(i.jsx)(l.Line,{points:[52,48,12,48,12,28,32,28,32,12,16,12,48,12,32,12,32,28,52,28,52,48],strokeWidth:4,stroke:"black",closed:!0},"base"),Object(i.jsx)(l.Line,{points:[18,32,32,42,46,32,18,32],strokeWidth:1,stroke:"blue",closed:!0,fill:"blue"},"arrow")]})}function D(e){return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"deleteTip",isEnabled:void 0!==e.selected,onClicked:function(){e.selected?e.simulator.remove(e.selected):S("Nothing is selected (click on a logic gate in the field to specify what should be deleted).")},children:Object(i.jsx)(l.Text,{text:"\ud83d\uddd1",x:10,y:8,fontSize:64,fill:"black"})})}function X(e){function t(){return(t=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.clipboard){t.next=3;break}return alert("Can't copy to clipboard - navigator.clipboard doesn't exist.  Perhaps you're using an older browser?"),t.abrupt("return");case 3:return n=window.location.origin+window.location.pathname+"?"+e.simulator.serializeToCompressedQueryStringFragment(),t.prev=4,t.next=7,navigator.clipboard.writeText(n);case 7:alert("Copied the following URL to the clipboard:\n\n"+n),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),alert("navigator.clipboard.writeText failed!\n\n"+t.t0);case 13:case"end":return t.stop()}}),t,null,[[4,10]])})))).apply(this,arguments)}return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"shareLinkTip",isEnabled:!0,onClicked:function(){return t.apply(this,arguments)},children:Object(i.jsx)(l.Text,{text:"\ud83d\udd17",x:6,y:14,fontSize:42,fill:"black"})})}function A(e){return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"saveTip",isEnabled:!0,onClicked:function(){var t=new File([JSON.stringify(e.simulator.serialize(),null,4)],"logicgatesim.json",{type:"text/plain;charset=utf-8"});O.a.saveAs(t)},children:Object(i.jsx)(l.Text,{text:"\ud83d\udcbe",x:6,y:14,fontSize:42,fill:"black"})})}function Y(e){var t=document.getElementById("fileElem");if(!t)throw new Error("index.html is busted - fileElem <input> is missing");return s.useEffect((function(){function n(){if(t.files&&0!==t.files.length){var n=new FileReader;n.onload=function(){var t,i=n.result;try{t=JSON.parse(i)}catch(o){return void alert("Failed to load the file - are you sure this is a file generated from this app?  "+o)}try{e.simulator.load(t)}catch(o){alert(o)}},n.readAsText(t.files[0])}}return t.addEventListener("change",n,!1),function(){return t.removeEventListener("change",n)}}),[e.simulator,t]),Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"loadTip",isEnabled:!0,onClicked:function(){t.click()},children:Object(i.jsx)(l.Text,{text:"\ud83d\udcc1",x:6,y:14,fontSize:42,fill:"black"})})}function W(e){return Object(i.jsx)(_,{x:e.x,y:e.y,toolTipId:"reloadTip",isEnabled:!0,onClicked:function(){return e.simulator.gameReload()},children:Object(i.jsx)(l.Text,{text:"\u21c5",x:16,y:14,fontSize:42,fill:"black"})})}var P=n(49),H={};function z(e){var t=Object(s.useState)([e.model.x,e.model.y]),n=Object(a.a)(t,2),o=Object(a.a)(n[0],2),r=o[0],u=o[1],d=n[1],f=Object(s.useState)(e.model.currentState),h=Object(a.a)(f,2),m=h[0],v=h[1],y=c.a.useRef(null);function b(t){if(!(e.model instanceof g.d))throw Error("Expected a logic gate");e.model.kind=t}function p(t){e.model.changeSize(t)}function k(t){e.model.isRecording=t}Object(s.useEffect)((function(){function t(){d([e.model.x,e.model.y])}return e.model.onMoved(t),function(){return e.model.offMoved(t)}}),[e.model]),Object(s.useEffect)((function(){function t(){v(e.model.currentState)}return e.model.onStateChanged(t),function(){return e.model.offStateChanged(t)}}),[e.model]);var x=c.a.useState(new T("interactableTip",e.model.x,e.model.y)),j=Object(a.a)(x,1)[0];var O=[];return O.push(Object(i.jsx)(l.Rect,{height:64,width:64,strokeWidth:5,stroke:e.isSelected?"green":"#ffb341",fill:m?"#26D0F9":"#384a50"},"surround")),e.model instanceof g.c&&O.push(Object(i.jsx)(F,{model:e.model},"savedStateIndicator")),e.model instanceof g.d?O.push(Object(i.jsx)(N,{model:e.model},"logicGate")):e.model instanceof g.a?O.push(Object(i.jsx)(U,{model:e.model},"input")):e.model instanceof g.e&&O.push(Object(i.jsx)(G,{model:e.model},"input")),Object(i.jsx)(l.Group,{onClick:function(t){e.onClick&&e.onClick({evt:t.evt,model:e.model})},onMouseUp:function(t){e.onMouseUp&&e.onMouseUp({evt:t.evt,model:e.model})},onMouseEnter:function(){if(e.model.description||e.model.generatedDescription){var t,n="";if(e.model.description)n+=P.a.parse(null!==(t=e.model.description)&&void 0!==t?t:"");var i=e.model.generatedDescription;i&&(n+='<p class="generatedDescription">'+i+"</p>"),document.getElementById("interactableTip").innerHTML=n,j.x=e.model.x,j.y=e.model.y,j.startTimer()}},onMouseLeave:function(){return j.clearTimer()},onMouseDown:function(){return j.clearTimer()},ref:y,draggable:!0,x:r,y:u,onContextMenu:function(t){t.evt.preventDefault();var n=document.getElementById("interactableMenu");n.style.display="initial",n.style.top=t.evt.pageY+"px",n.style.left=t.evt.pageX+"px",document.getElementById("menuItemToAnd").style.display=e.model instanceof g.d&&"and"!==e.model.kind?"":"none",document.getElementById("menuItemToNand").style.display=e.model instanceof g.d&&"nand"!==e.model.kind?"":"none",document.getElementById("menuItemToOr").style.display=e.model instanceof g.d&&"or"!==e.model.kind?"":"none",document.getElementById("menuItemToNor").style.display=e.model instanceof g.d&&"nor"!==e.model.kind?"":"none",document.getElementById("menuItemToXor").style.display=e.model instanceof g.d&&"xor"!==e.model.kind?"":"none",document.getElementById("menuItemToXnor").style.display=e.model instanceof g.d&&"xnor"!==e.model.kind?"":"none",document.getElementById("menuItemAddOneTick").style.display=e.model instanceof g.e?"":"none",document.getElementById("menuItemAddFiveTicks").style.display=e.model instanceof g.e?"":"none",document.getElementById("menuItemMinusOneTick").style.display=e.model instanceof g.e?"":"none",document.getElementById("menuItemMinusFiveTicks").style.display=e.model instanceof g.e?"":"none",document.getElementById("menuItemToggle").style.display=e.model instanceof g.a?"":"none",document.getElementById("menuItemRecordOn").style.display=e.model instanceof g.a&&!e.model.isRecording?"":"none",document.getElementById("menuItemRecordOff").style.display=e.model instanceof g.a&&e.model.isRecording?"":"none",document.getElementById("menuItemPaint").style.display=e.model instanceof g.e?"none":"",e.model instanceof g.a&&(document.getElementById("menuItemToggle").innerText=e.model.currentState?"Toggle off":"Toggle on"),document.getElementById("menuItemToAnd").onclick=function(){return b("and")},document.getElementById("menuItemToNand").onclick=function(){return b("nand")},document.getElementById("menuItemToOr").onclick=function(){return b("or")},document.getElementById("menuItemToNor").onclick=function(){return b("nor")},document.getElementById("menuItemToXor").onclick=function(){return b("xor")},document.getElementById("menuItemToXnor").onclick=function(){return b("xnor")},document.getElementById("menuItemToggle").onclick=function(){return function(){if(!(e.model instanceof g.a))throw Error("Expected an Input");e.model.toggle()}()},document.getElementById("menuItemDescribe").onclick=function(){return function(){var t,n=document.getElementById("tooltipEditor");n.model=e.model;var i=document.getElementById("tooltipText");i.value=null!==(t=e.model.description)&&void 0!==t?t:"",n.classList.add("visible"),setTimeout((function(){i.focus()}),100)}()},document.getElementById("menuItemPaint").onclick=function(){return e.model.paint()},document.getElementById("menuItemAddOneTick").onclick=function(){return p(1)},document.getElementById("menuItemMinusOneTick").onclick=function(){return p(-1)},document.getElementById("menuItemAddFiveTicks").onclick=function(){return p(5)},document.getElementById("menuItemMinusFiveTicks").onclick=function(){return p(-5)},document.getElementById("menuItemRecordOn").onclick=function(){return k(!0)},document.getElementById("menuItemRecordOff").onclick=function(){return k(!1)}},onDragStart:function(t){if(!t.evt.shiftKey){if(!y.current)throw new Error("group did not get set in render");y.current.stopDrag(),e.onLinkStart&&e.onLinkStart({evt:t.evt,model:e.model})}},onDragMove:function(t){var n=t.target.absolutePosition();e.model.setPosition(n.x,n.y)},onDragEnd:function(t){e.onMoveCompleted&&e.onMoveCompleted({evt:t.evt,model:e.model})},children:O})}function F(e){var t=Object(s.useState)(e.model.savedState),n=Object(a.a)(t,2),o=n[0],r=n[1];Object(s.useEffect)((function(){function t(){r(e.model.savedState)}return e.model.onStateChanged(t),function(){return e.model.offStateChanged(t)}}),[e.model]);return Object(i.jsx)(l.Line,{points:[47,0,63,0,63,16],fill:o?"orange":"transparent",stroke:"orange",strokeWidth:4,closed:!0},"saveStateIndicator")}function N(e){var t=Object(s.useState)(e.model.kind),n=Object(a.a)(t,2),o=n[0],r=n[1];Object(s.useEffect)((function(){function t(){r(e.model.kind)}return e.model.onStateChanged(t),function(){return e.model.offStateChanged(t)}}),[e.model]);var c=Object(s.useState)(e.model.currentState),u=Object(a.a)(c,2),d=u[0],f=u[1];Object(s.useEffect)((function(){function t(){f(e.model.currentState)}return e.model.onStateChanged(t),function(){return e.model.offStateChanged(t)}}),[e.model]);var h=o+(d?"-white":"");return Object(i.jsx)(l.Image,{x:0,y:0,image:H[h].image()})}function U(e){var t=Object(s.useState)(e.model.currentState),n=Object(a.a)(t,2),o=n[0],r=n[1];return Object(s.useEffect)((function(){function t(){r(e.model.currentState)}return e.model.onStateChanged(t),function(){return e.model.offStateChanged(t)}}),[e.model]),Object(i.jsx)(l.Circle,{radius:22,x:32,y:32,strokeWidth:8,stroke:o?"white":"black"},"image")}function G(e){var t=Object(s.useState)(e.model.tickStorage),n=Object(a.a)(t,2),o=n[0],c=n[1];Object(s.useEffect)((function(){function t(){c(Object(r.a)(e.model.tickStorage))}return e.model.onStateChanged(t),function(){return e.model.offStateChanged(t)}}),[e.model]);var u=52/o.length;function d(e){var t=o.length,n=e<o.length/2?e:o.length-1-e;return n<.2*t?0:n>.4*t?6:6*(n-.2*t)/(.2*t)}return Object(i.jsx)(l.Group,{children:o.map((function(e,t){return Object(i.jsx)(l.Rect,{x:12+d(t),width:40-2*d(t),y:58-u-52*t/o.length,height:u,strokeWidth:1,stroke:"darkgrey",fill:e?"blue":"white"},t.toString())}))})}function Q(e,t,n,i){if(Math.abs(i-t)<Math.abs(n-e)){var o=n>e?1:-1,r=32*(i-t)/(n-e);e+=32*o,n-=32*o,t+=o*r,i-=o*r}else{var a=i>t?1:-1,s=32*(n-e)/(i-t);e+=a*s,n-=a*s,t+=32*a,i-=32*a}return[e,t,n,i]}function J(e){var t=c.a.useState(e.source.prevState),n=Object(a.a)(t,2),o=n[0],r=n[1],u=c.a.useState(Q(e.source.x+32,e.source.y+32,e.target.x+32,e.target.y+32)),d=Object(a.a)(u,2),f=Object(a.a)(d[0],4),h=f[0],m=f[1],v=f[2],g=f[3],y=d[1];return Object(s.useEffect)((function(){function t(){r(e.source.prevState)}function n(){y(Q(e.source.x+32,e.source.y+32,e.target.x+32,e.target.y+32))}return e.source.onStateChanged(t),e.source.onMoved(n),e.target.onMoved(n),function(){e.source.offStateChanged(t),e.source.offMoved(n),e.target.offMoved(n)}}),[e.source,e.target]),Object(i.jsx)(l.Arrow,{x:h,y:m,points:[0,0,v-h,g-m],fill:o?"darkblue":"teal",stroke:o?"darkblue":"teal",strokeWidth:4,pointerLength:10,pointerWidth:10})}function K(){var e=document.getElementById("content"),t=.9*window.innerHeight,n=e.clientWidth,i=n<1437?2:1,o=72*i+8,r=function(e){return t-o+8+(e>=9&&i>1?72:0)};return{canvasWidth:n,canvasHeight:t,buttonRowHeight:o,maxSensibleDropX:n-16,maxSensibleDropY:r(0)-32,buttonRowX:function(e){return 15+79*(e>=9&&i>1?e-9:e)},buttonRowY:r}}function q(e){var t=s.useState(e.simulator.interactables),n=Object(a.a)(t,2),c=n[0],u=n[1],d=s.useState(e.simulator.getLinks()),h=Object(a.a)(d,2),m=h[0],v=h[1],y=s.useState(void 0),b=Object(a.a)(y,2),p=b[0],k=b[1],x=s.useState(void 0),j=Object(a.a)(x,2),O=j[0],S=j[1],w=s.useState([void 0,void 0]),T=Object(a.a)(w,2),_=Object(a.a)(T[0],2),I=_[0],P=_[1],H=T[1],F=s.useState(void 0),N=Object(a.a)(F,2),U=N[0],G=N[1],Q=s.useState(K()),q=Object(a.a)(Q,2),V=q[0],Z=q[1],$=s.useState(!1),ee=Object(a.a)($,2),te=ee[0],ne=ee[1],ie=s.useRef(null);function oe(e){e.evt.ctrlKey&&e.model instanceof g.a&&e.model.toggle(),k(e.model)}function re(e){S(e.model),H([e.evt.x,e.evt.y])}function ae(e){G(e.prototype)}function se(t){(t.model.x<-48||t.model.y<-48||t.model.x>V.maxSensibleDropX||t.model.y>V.maxSensibleDropY)&&e.simulator.remove(t.model)}s.useEffect((function(){function t(){p&&e.simulator.interactables.indexOf(p)<0&&k(void 0),u(Object(r.a)(e.simulator.interactables)),v(e.simulator.getLinks()),S(void 0),G(void 0)}function n(){t(),ne(!0)}return e.simulator.onInteractableAdded(t),e.simulator.onInteractableRemoved(t),e.simulator.onInteractablesReset(n),function(){e.simulator.offInteractableAdded(t),e.simulator.offInteractableRemoved(t),e.simulator.offInteractablesReset(n)}}),[e.simulator,p]),s.useEffect((function(){var e=document.getElementById("content"),t=new ResizeObserver((function(){Z(K()),ne(!0)}));return t.observe(e),function(){return t.disconnect()}}),[]),s.useEffect((function(){function t(t){var n,i=null===(n=ie.current)||void 0===n?void 0:n.getPointerPosition();if(!i)throw new Error("stage was not set?");function o(t,n){var i=new g.d({kind:t,x:n.x,y:n.y,savedState:!1});e.simulator.add(i),k(i)}if("g"===t.key)e.simulator.startRunning();else if("s"===t.key)e.simulator.stopRunning();else if("n"===t.key)e.simulator.advanceOne();else if("a"===t.key)o("and",i);else if("o"===t.key)o("or",i);else if("x"===t.key)o("xor",i);else if("A"===t.key)o("nand",i);else if("O"===t.key)o("nor",i);else if("X"===t.key)o("xnor",i);else if("i"===t.key){var r=new g.a({kind:"input",x:i.x,y:i.y,savedState:!1});e.simulator.add(r),k(r)}else if("t"===t.key){var a=new g.e({kind:"timer",x:i.x,y:i.y,tickStorage:new Array(10).fill(!1)});e.simulator.add(a),k(a)}else p&&" "===t.key?(p.toggle(),t.preventDefault()):"4"===t.key?e.simulator.gameReload():"l"===t.key?e.simulator.putOnLift():"L"===t.key?e.simulator.takeOffLift():"p"===t.key&&p&&p.paint();console.debug("App.handleKeyPress("+t.key+")")}if(ie.current){var n=ie.current.container();n.tabIndex=1,n.focus()}return window.addEventListener("keypress",t),function(){return window.removeEventListener("keypress",t)}}),[e.simulator,p]),s.useEffect((function(){var t=document.getElementById("menuItemDelete");return t.onclick=function(){p&&e.simulator.remove(p)},function(){t.onclick=null}}),[e.simulator,p]),s.useEffect((function(){function t(t){var n;if(!(null===(n=ie.current)||void 0===n?void 0:n.getPointerPosition()))throw new Error("stage was not set?");"Delete"!==t.key&&"Backspace"!==t.key||!p||e.simulator.remove(p)}if(ie.current){var n=ie.current.container();n.tabIndex=1,n.focus()}return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[e.simulator,p]);var ce=document.getElementById("tooltipEditor");function ue(){var e;ce.model.description=null!==(e=document.getElementById("tooltipText").value)&&void 0!==e?e:void 0,ce.classList.remove("visible")}function le(){ce.classList.remove("visible")}document.getElementById("tooltipText").onkeydown=function(e){"Escape"===e.key?le():"Enter"===e.key&&(e.shiftKey||e.ctrlKey)&&ue()},document.getElementById("tooltipEditorOk").onclick=ue,document.getElementById("tooltipEditorCancel").onclick=le,ce.onkeydown=function(e){e.stopPropagation()},ce.onkeyup=function(e){e.stopPropagation()},ce.onkeypress=function(e){e.stopPropagation()};var de=[];return te&&(e.simulator.fitToSize(V.canvasWidth,V.buttonRowY(0),20,20),ne(!1)),O&&(de=Object(i.jsx)(l.Arrow,{x:O.x+32,y:O.y+32,points:[0,0,I-(O.x+32),P-(O.y+32)],fill:"lightgrey",stroke:"lightgrey",strokeWidth:4,pointerLength:10,pointerWidth:10})),Object(i.jsxs)(l.Stage,{width:V.canvasWidth-4,height:V.canvasHeight,ref:ie,onMouseUp:function(t){if(O){var n,i=void 0,r=Object(o.a)(c);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.x<=t.evt.offsetX&&t.evt.offsetX<a.x+64&&a.y<=t.evt.offsetY&&t.evt.offsetY<a.y+64){i=a;break}}}catch(s){r.e(s)}finally{r.f()}i&&i!==O&&i.addInput(O)&&(v(e.simulator.getLinks()),S(void 0),G(void 0))}else U&&U.y<V.maxSensibleDropY&&e.simulator.add(U);S(void 0),G(void 0)},onMouseMove:function(e){O?H([e.evt.offsetX,e.evt.offsetY]):U&&U.setPosition(e.evt.offsetX,e.evt.offsetY)},onMouseLeave:function(){S(void 0),G(void 0)},children:[Object(i.jsxs)(l.Layer,{children:[Object(i.jsx)(l.Rect,{id:"background",x:0,y:0,width:V.canvasWidth,height:V.canvasHeight-V.buttonRowHeight,onMouseDown:function(e){e.target instanceof z||!p||k(void 0)},strokeWidth:0,fill:"GhostWhite"}),Object(i.jsx)(f,{simulator:e.simulator,right:V.canvasWidth-20,top:5}),c.map((function(e){return Object(i.jsx)(z,{model:e,isSelected:e===p,onLinkStart:re,onClick:oe,onMoveCompleted:se},e.id.toString())})),U?Object(i.jsx)(z,{model:U,isSelected:!1},U.id.toString()):[],de,m.map((function(e){return Object(i.jsx)(J,{source:e.source,target:e.target},e.source.id.toString()+"-"+e.target.id.toString())}))]}),Object(i.jsxs)(l.Layer,{children:[Object(i.jsx)(l.Rect,{x:0,y:V.canvasHeight-V.buttonRowHeight,height:V.buttonRowHeight,width:V.canvasWidth,fill:"papayawhip"}),Object(i.jsx)(l.Line,{points:[0,V.canvasHeight-V.buttonRowHeight,V.canvasWidth,V.canvasHeight-V.buttonRowHeight],stroke:"grey",strokeWidth:3}),Object(i.jsx)(C,{x:V.buttonRowX(0),y:V.buttonRowY(0),selected:p,kind:"and",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(1),y:V.buttonRowY(1),selected:p,kind:"or",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(2),y:V.buttonRowY(2),selected:p,kind:"xor",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(3),y:V.buttonRowY(3),selected:p,kind:"nand",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(4),y:V.buttonRowY(4),selected:p,kind:"nor",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(5),y:V.buttonRowY(5),selected:p,kind:"xnor",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(6),y:V.buttonRowY(6),selected:p,kind:"input",onBeginDrag:ae}),Object(i.jsx)(C,{x:V.buttonRowX(7),y:V.buttonRowY(7),selected:p,kind:"timer",onBeginDrag:ae}),Object(i.jsx)(D,{x:V.buttonRowX(8),y:V.buttonRowY(8),simulator:e.simulator,selected:p}),Object(i.jsx)(E,{x:V.buttonRowX(9),y:V.buttonRowY(9),model:e.simulator}),Object(i.jsx)(R,{x:V.buttonRowX(10),y:V.buttonRowY(10),model:e.simulator}),Object(i.jsx)(W,{x:V.buttonRowX(11),y:V.buttonRowY(11),simulator:e.simulator}),Object(i.jsx)(B,{x:V.buttonRowX(12),y:V.buttonRowY(12),selected:p}),Object(i.jsx)(L,{x:V.buttonRowX(13),y:V.buttonRowY(13),simulator:e.simulator}),Object(i.jsx)(M,{x:V.buttonRowX(14),y:V.buttonRowY(14),simulator:e.simulator}),Object(i.jsx)(X,{x:V.buttonRowX(15),y:V.buttonRowY(15),simulator:e.simulator}),Object(i.jsx)(Y,{x:V.buttonRowX(16),y:V.buttonRowY(16),simulator:e.simulator}),Object(i.jsx)(A,{x:V.buttonRowX(17),y:V.buttonRowY(17),simulator:e.simulator})]})]})}function V(){var e=document.getElementById("interactableMenu");if(!e)throw Error("Missing div with id: interactableMenu");e.style.display="none"}function Z(){var e=document.getElementById("helpButton"),t=document.getElementById("content"),n=document.getElementById("sidebar");"Help >>"===e.innerText?(e.innerText="Help <<",t.classList.add("content-full"),n.classList.add("sidebar-none")):(e.innerText="Help >>",t.classList.remove("content-full"),n.classList.remove("sidebar-none"))}function $(e){e.storeInCookie(),setTimeout($,3e3,e)}var ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,105)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),o(e),r(e),a(e)}))};console.debug("In index"),window.addEventListener("click",V),document.getElementById("helpButton").onclick=Z,function(e){for(var t=["and-white","and-black","or-white","or-black","xor-white","xor-black","nand-white","nand-black","nor-white","nor-black","xnor-white","xnor-black","paint-black"],n=function(){var n=o[i];v.a.Image.fromURL("/ScrapMechanicLogicGateSimulator/"+n+".png",(function(i){H[n.replace("-black","")]=i,Object.keys(H).length===t.length&&e()}))},i=0,o=t;i<o.length;i++)n()}((function(){var e=new d.a;try{e.loadFromQsAndCookie()}catch(t){alert(t)}setTimeout($,3,e),Object(u.render)(Object(i.jsx)(q,{simulator:e}),document.getElementById("root"))})),ee()},4:function(e,t,n){"use strict";n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return b})),n.d(t,"e",(function(){return p}));var i=n(17),o=n(14),r=n(21),a=n(20),s=n(15),c=n(16),u=n(11),l=n(12),d=n(25);function f(e,t){return e.hasOwnProperty(t)}function h(e,t){if(!f(e,"x")||"number"!==typeof e.x)throw new Error("Missing 'x' property or 'x' is not a number");if(!f(e,"y")||"number"!==typeof e.y)throw new Error("Missing 'x' property or 'x' is not a number");if(!f(e,"y")||"number"!==typeof e.y)throw new Error("Missing 'x' property or 'x' is not a number");var n=f(e,"description")&&"string"===typeof e.description?e.description:void 0;return{kind:t,x:e.x,y:e.y,description:n,inputs:[]}}var m=function(){function e(t){Object(u.a)(this,e),this._x=void 0,this._y=void 0,this._events=void 0,this._inputs=void 0,this._description=void 0,this._prevState=void 0,this._currentState=void 0,this.id=void 0,this._events=new d.EventEmitter,this._prevState=!1,this._currentState=!1,this._inputs=[],this._x=t.x,this._y=t.y,this._description=t.description,this.id=++e.idCounter}return Object(l.a)(e,[{key:"getPosition",value:function(){return{x:this._x,y:this._y}}},{key:"setPosition",value:function(e,t){this._x=e,this._y=t,this._emitMoved(e,t)}},{key:"setCurrentState",value:function(e){this._currentState!==e&&(this._currentState=e,this._emitStateChanged())}},{key:"setPrevState",value:function(e){this._prevState!==e&&(this._prevState=e,this._emitStateChanged())}},{key:"export",value:function(){return{x:this._x,y:this._y,kind:"input",description:this._description,inputs:[]}}},{key:"addInput",value:function(e){if(0===this.inputLimit)return!1;var t=this.inputs.indexOf(e);if(t>=0)this._inputs.splice(t,1);else{var n=e.inputs.indexOf(this);n>=0&&(e._inputs.splice(n,1),e.calculate()),1===this.inputLimit&&(this._inputs=[]),this._inputs.push(e)}return this.calculate(),this.paint(),e.paint(),!0}},{key:"removeInput",value:function(e){var t=this.inputs.indexOf(e);return!(t<0)&&(this._inputs.splice(t,1),this.calculate(),this.paint(),!0)}},{key:"setInputs",value:function(e){this._inputs=Object(c.a)(e)}},{key:"toggle",value:function(){}},{key:"apply",value:function(){this.setPrevState(this.currentState)}},{key:"calculate",value:function(){}},{key:"reload",value:function(){}},{key:"putOnLift",value:function(){}},{key:"paint",value:function(){}},{key:"onMoved",value:function(e){this._events.on("moved",e)}},{key:"offMoved",value:function(e){this._events.off("moved",e)}},{key:"onStateChanged",value:function(e){this._events.on("stateChanged",e)}},{key:"offStateChanged",value:function(e){this._events.off("stateChanged",e)}},{key:"_emitMoved",value:function(e,t){this._events.emit("moved",{source:this,x:e,y:t})}},{key:"_emitStateChanged",value:function(){this._events.emit("stateChanged",{source:this})}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"description",get:function(){return this._description},set:function(e){this._description=e}},{key:"generatedDescription",get:function(){}},{key:"currentState",get:function(){return this._currentState}},{key:"prevState",get:function(){return this._prevState}},{key:"inputs",get:function(){return Object(c.a)(this._inputs)}},{key:"inputLimit",get:function(){return"unlimited"}}],[{key:"validateAndDeserialize",value:function(e){if("object"!==typeof e||null===e)throw new Error("Bad format - expected an array of objects at the top level");if(!f(e,"kind"))throw new Error("Interactable is missing an 'inputs' array");switch(e.kind){case"input":case"input-on":case"input-off":return new b(function(e,t){return v(e,"input","input-on"===t)}(e,e.kind));case"timer":case"timer10":return new p(function(e){var t;f(e,"tickStorage")&&(t=e.tickStorage);f(e,"timerTickStorage")&&(t=e.timerTickStorage);if(void 0===t||!Array.isArray(t)||!t.every((function(e){return"boolean"===typeof e})))throw new Error("Timer interactables should have a boolean array named 'tickStorage'");return Object(s.a)(Object(s.a)({},h(e,"timer")),{},{tickStorage:t})}(e));case"and":case"or":case"xor":case"nand":case"nor":case"xnor":return new y(function(e,t){return v(e,t,!1)}(e,e.kind));default:throw new Error("Interactable has unknown 'kind': "+e.kind)}}}]),e}();function v(e,t,n){var i=n;if(f(e,"savedState")){if("boolean"!==typeof e.savedState)throw new Error("Interactables of kind '"+t+"' should have a 'savedState' property of type boolean");i=e.savedState}return Object(s.a)(Object(s.a)({},h(e,t)),{},{savedState:i})}m.idCounter=0;var g=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var i;return Object(u.a)(this,n),(i=t.call(this,e))._savedState=void 0,i._savedState=e.savedState,i}return Object(l.a)(n,[{key:"export",value:function(){return Object(s.a)(Object(s.a)({},Object(i.a)(Object(o.a)(n.prototype),"export",this).call(this)),{},{savedState:this._savedState})}},{key:"paint",value:function(){this._savedState!==this.currentState&&(this._savedState=this.currentState,Object(i.a)(Object(o.a)(n.prototype),"_emitStateChanged",this).call(this))}},{key:"reload",value:function(){this.setCurrentState(this.savedState),this.setPrevState(!1)}},{key:"savedState",get:function(){return this._savedState}}]),n}(m);var y=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var i;if(Object(u.a)(this,n),(i=t.call(this,e))._kind=void 0,"timer"===e.kind||"input"===e.kind)throw new Error("Caller should prevent this");return i._kind=e.kind,i}return Object(l.a)(n,[{key:"calculate",value:function(){var e,t=this.inputs.reduce((function(e,t){return e+(t.prevState?1:0)}),0);switch(this.kind){case"and":e=this.inputs.length>0&&t===this.inputs.length;break;case"or":e=this.inputs.length>0&&t>0;break;case"xor":e=t%2===1;break;case"nand":e=this.inputs.length>0&&t!==this.inputs.length;break;case"nor":e=this.inputs.length>0&&0===t;break;case"xnor":e=this.inputs.length>0&&t%2===0}this.setCurrentState(e)}},{key:"putOnLift",value:function(){this.setCurrentState(this.inputs.length>0&&("nand"===this.kind||"nor"===this.kind||"xnor"===this.kind)),this.setPrevState(!1),this.paint()}},{key:"export",value:function(){return Object(s.a)(Object(s.a)({},Object(i.a)(Object(o.a)(n.prototype),"export",this).call(this)),{},{kind:this._kind})}},{key:"kind",get:function(){return this._kind},set:function(e){this._kind=e,this._emitStateChanged(),this.paint()}},{key:"inputLimit",get:function(){return"unlimited"}}]),n}(g);var b=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var i;return Object(u.a)(this,n),(i=t.call(this,e))._savedToggles=void 0,i._tickCount=0,i}return Object(l.a)(n,[{key:"toggle",value:function(){if(this.setCurrentState(!this.currentState),void 0!==this._savedToggles){for(;this._savedToggles.length>0&&this._savedToggles[this._savedToggles.length-1]>this._tickCount;)this._savedToggles.splice(this._savedToggles.length-1,1);this._savedToggles.length>0&&this._savedToggles[this._savedToggles.length-1]===this._tickCount?this._savedToggles.splice(this._savedToggles.length-1,1):this._savedToggles.push(this._tickCount)}}},{key:"putOnLift",value:function(){this.setCurrentState(!1),this.setPrevState(!1),this.paint()}},{key:"apply",value:function(){Object(i.a)(Object(o.a)(n.prototype),"apply",this).call(this),this._tickCount+=1}},{key:"calculate",value:function(){void 0!==this._savedToggles&&this._savedToggles.indexOf(this._tickCount)>=0&&this.setCurrentState(!this.currentState)}},{key:"reload",value:function(){this._tickCount=0,Object(i.a)(Object(o.a)(n.prototype),"reload",this).call(this),void 0!==this._savedToggles&&this._savedToggles.length>0&&0===this._savedToggles[0]&&this.setCurrentState(!this.currentState)}},{key:"isRecording",get:function(){return void 0!==this._savedToggles},set:function(e){this._savedToggles=void 0===this._savedToggles?[]:void 0}},{key:"generatedDescription",get:function(){if(void 0!==this._savedToggles&&0!==this._savedToggles.length){for(var e="on at tick "+this._savedToggles[0],t="off",n=1;n<this._savedToggles.length;++n)e+="; "+t+" at "+this._savedToggles[n],t="off"===t?"on":"off";return e}}},{key:"inputLimit",get:function(){return 0}}]),n}(g);var p=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var i;return Object(u.a)(this,n),(i=t.call(this,e))._tickStorage=void 0,i._tickStorage=Object(c.a)(e.tickStorage),i}return Object(l.a)(n,[{key:"changeSize",value:function(e){if(e<0){var t=Math.min(-e,this._tickStorage.length-1);t>0&&this._tickStorage.splice(this._tickStorage.length-t,t)}else for(var n=Math.min(e,30-this._tickStorage.length);n>0;)this._tickStorage.push(!1),n-=1;this._emitStateChanged()}},{key:"export",value:function(){return Object(s.a)(Object(s.a)({},Object(i.a)(Object(o.a)(n.prototype),"export",this).call(this)),{},{kind:"timer",tickStorage:this._tickStorage})}},{key:"calculate",value:function(){for(var e=0;e<this._tickStorage.length-1;++e)this._tickStorage[this._tickStorage.length-1-e]=this._tickStorage[this._tickStorage.length-2-e];this._tickStorage[0]=this.inputs.length>0&&this.inputs[0].prevState,this.setCurrentState(this._tickStorage[this._tickStorage.length-1]),this._emitStateChanged()}},{key:"putOnLift",value:function(){for(var e=0;e<this._tickStorage.length;++e)this._tickStorage[e]=!1;this.setCurrentState(!1),this.setPrevState(!1),this._emitStateChanged()}},{key:"generatedDescription",get:function(){return this._tickStorage.length-1+"-tick timer ("+this._tickStorage.length+" ticks of actual saved state)"}},{key:"tickStorage",get:function(){return Object(c.a)(this._tickStorage)}},{key:"inputLimit",get:function(){return 1}}]),n}(m)},46:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var i=n(13),o=n(11),r=n(12),a=n(25),s=n(33),c=n(4),u=function(){function t(){Object(o.a)(this,t),this._nextTickTimeoutId=void 0,this._pauseInterval=void 0,this._events=void 0,this.currentTick=void 0,this.isRunning=void 0,this.interactables=void 0,this._events=new a.EventEmitter,this.currentTick=0,this.isRunning=!1,this._nextTickTimeoutId=void 0,this._pauseInterval=250,this.interactables=[]}return Object(r.a)(t,[{key:"serialize",value:function(){var e=this;return this.interactables.map((function(t){return function(e,t){var n=e.export();return n.inputs=e.inputs.map((function(e){return t.indexOf(e)})),n}(t,e.interactables)}))}},{key:"load",value:function(e){if(!Array.isArray(e))throw new Error("Bad format - expected an array at the top level");for(var t=e.map((function(e){return c.b.validateAndDeserialize(e)})),n=0;n<t.length;++n){var o=e[n],r=t[n];if("object"!==typeof o||null===o)throw new Error("Bad format - expected an array of objects at the top level");if(!Object(c.f)(o,"inputs"))throw new Error("Interactable is missing an 'inputs' array");if(!Array.isArray(o.inputs))throw new Error("Interactable 'inputs' field should be an array of indices");var a,s=Object(i.a)(o.inputs);try{for(s.s();!(a=s.n()).done;){var u=a.value;if("number"!==typeof u)throw new Error("'inputs' should consist of numbers");if(u<0||u>=t.length)throw new Error("'inputs' has an index that is out of range");r.addInput(t[u])}}catch(d){s.e(d)}finally{s.f()}}var l=this.interactables;this.interactables=t,this._emitInteractablesReset({simulator:this,oldInteractables:l}),this.stopRunning()}},{key:"loadFromQsAndCookie",value:function(){for(var e,n,i=window.location.search,o=document.cookie.split(";"),r=!1,a=0;a<o.length;a++){var s=o[a].trimStart();s.startsWith("state=")&&(e=s.substring(6,s.length)),s.startsWith("hash=")&&""!==i&&(r=t._hashCode(i).toString()===s.substring(5,s.length))}r&&void 0!==e||""===i?n=e:""!==i&&(n=i);var c=[];if(n)try{c=t.decompressQueryStringFragment(n)}catch(u){throw Error("The query string doesn't seem to be something created by this app - was it perhaps truncated?")}this.load(c)}},{key:"storeInCookie",value:function(){var e=new Date;e.setTime(e.getTime()+2592e6);var n=";expires="+e.toUTCString()+";path=/";document.cookie="state="+this.serializeToCompressedQueryStringFragment()+n;var i=window.location.search;i&&(document.cookie="hash="+t._hashCode(i)+n)}},{key:"fitToSize",value:function(e,t,n,o){if(!this.interactables.every((function(n){return n.x>=0&&n.x<e-64&&n.y>=0&&n.y<t-64}))){var r,a=this.interactables.reduce((function(e,t){return Math.max(e,t.x)}),0),s=this.interactables.reduce((function(e,t){return Math.max(e,t.y)}),0),c=this.interactables.reduce((function(e,t){return Math.min(e,t.x)}),999999),u=this.interactables.reduce((function(e,t){return Math.min(e,t.y)}),999999),l=Object(i.a)(this.interactables);try{for(l.s();!(r=l.n()).done;){var d=r.value,f=n+(d.x-c)*(e-2*n-64)/a,h=o+(d.y-u)*(t-2*o-64)/s;d.setPosition(f,h)}}catch(m){l.e(m)}finally{l.f()}}}},{key:"gameReload",value:function(){var e,t=Object(i.a)(this.interactables);try{for(t.s();!(e=t.n()).done;){e.value.reload()}}catch(n){t.e(n)}finally{t.f()}this.currentTick=0,this._emitTick()}},{key:"putOnLift",value:function(){var e,t=Object(i.a)(this.interactables);try{for(t.s();!(e=t.n()).done;){e.value.putOnLift()}}catch(n){t.e(n)}finally{t.f()}}},{key:"takeOffLift",value:function(){var e,t=Object(i.a)(this.interactables);try{for(t.s();!(e=t.n()).done;){e.value.paint()}}catch(n){t.e(n)}finally{t.f()}}},{key:"serializeToCompressedQueryStringFragment",value:function(){var t=JSON.stringify(this.serialize()),n=s.a.deflate(t),i=e.from(n).toString("base64");return encodeURIComponent(i)}},{key:"startRunning",value:function(){this.isRunning||(this.isRunning=!0,this._nextTickTimeoutId=setTimeout(this._handleTickTimeout.bind(this),this._pauseInterval),this._events.emit("runStateChanged",{simulator:this,newRunState:this.isRunning}))}},{key:"stopRunning",value:function(){this.isRunning&&(this.isRunning=!1,this._nextTickTimeoutId&&clearTimeout(this._nextTickTimeoutId),this._nextTickTimeoutId=void 0,this._events.emit("runStateChanged",{simulator:this,newRunState:this.isRunning}))}},{key:"advanceOne",value:function(){this.isRunning?this.stopRunning():this._advanceOne()}},{key:"add",value:function(e){this.interactables.push(e),this._events.emit(l.interactableAdded,{simulator:this,interactable:e})}},{key:"remove",value:function(e){for(var t=!1,n=this.interactables.length-1;n>=0;--n)this.interactables[n]===e&&(t=!0,this.interactables.splice(n,1));var o,r=Object(i.a)(this.interactables);try{for(r.s();!(o=r.n()).done;){o.value.removeInput(e)}}catch(a){r.e(a)}finally{r.f()}return t&&this._events.emit(l.interactableRemoved,{simulator:this,interactable:e}),t}},{key:"getLinks",value:function(){return this.interactables.map((function(e){return e.inputs.map((function(t){return{source:t,target:e}}))})).reduce((function(e,t){return e.concat(t)}),[])}},{key:"_advanceOne",value:function(){++this.currentTick,this._emitTick();var e,t=Object(i.a)(this.interactables);try{for(t.s();!(e=t.n()).done;){e.value.apply()}}catch(r){t.e(r)}finally{t.f()}var n,o=Object(i.a)(this.interactables);try{for(o.s();!(n=o.n()).done;){n.value.calculate()}}catch(r){o.e(r)}finally{o.f()}}},{key:"onTick",value:function(e){this._events.on(l.tick,e)}},{key:"offTick",value:function(e){this._events.off(l.tick,e)}},{key:"_emitTick",value:function(){this._events.emit(l.tick,{simulator:this,tick:this.currentTick})}},{key:"onInteractableAdded",value:function(e){this._events.on(l.interactableAdded,e)}},{key:"offInteractableAdded",value:function(e){this._events.off(l.interactableAdded,e)}},{key:"onInteractableRemoved",value:function(e){this._events.on(l.interactableRemoved,e)}},{key:"offInteractableRemoved",value:function(e){this._events.off(l.interactableRemoved,e)}},{key:"onRunStateChanged",value:function(e){this._events.on("runStateChanged",e)}},{key:"offRunStateChanged",value:function(e){this._events.off("runStateChanged",e)}},{key:"onInteractablesReset",value:function(e){this._events.on("interactablesReset",e)}},{key:"offInteractablesReset",value:function(e){this._events.off("interactablesReset",e)}},{key:"_emitInteractablesReset",value:function(e){this._events.emit("interactablesReset",e)}},{key:"_handleTickTimeout",value:function(){this._advanceOne(),this._nextTickTimeoutId=setTimeout(this._handleTickTimeout.bind(this),this._pauseInterval)}}],[{key:"_hashCode",value:function(e){return e.split("").reduce((function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e}),0)}},{key:"decompressQueryStringFragment",value:function(t){var n=decodeURIComponent(t),i=e.from(n,"base64"),o=s.a.inflate(i,{to:"string"});return JSON.parse(o)}}]),t}(),l={tick:"tick",interactableAdded:"interactableAdded",interactableRemoved:"interactableRemoved"}}).call(this,n(99).Buffer)},50:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.6e17f978.chunk.js.map